<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>üéß –ö–≤–µ—Å—Ç –¥–ª—è –°—Ç–∞—Å–∞</title>
  <style>
    :root{
      --bg:#0b0f19; --card:rgba(255,255,255,.08); --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.66); --accent:#7cf7d4; --danger:#ff6b6b; --ok:#9cff8f;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 700px at 20% 10%, rgba(124,247,212,.16), transparent 60%),
                  radial-gradient(900px 600px at 90% 20%, rgba(124,140,247,.12), transparent 55%),
                  var(--bg);
      min-height:100vh; display:grid; place-items:center; padding:24px;
    }
    .wrap{width:min(760px,100%)}
    .card{
      background: linear-gradient(180deg,var(--card),rgba(255,255,255,.06));
      border:1px solid rgba(255,255,255,.14);
      border-radius:20px; padding:22px; box-shadow:0 16px 60px rgba(0,0,0,.35);
      backdrop-filter: blur(10px);
    }
    .top{display:flex; gap:12px; align-items:center; justify-content:space-between; margin-bottom:14px}
    .badge{
      padding:6px 10px; border-radius:999px;
      background: rgba(124,247,212,.14);
      border:1px solid rgba(124,247,212,.28);
      color: var(--accent);
      font-size:12px; white-space:nowrap;
    }
    h1{margin:0 0 8px; font-size:22px}
    p{margin:0 0 14px; color:var(--muted); line-height:1.45}
    .progress{height:10px; background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.12);
      border-radius:999px; overflow:hidden; margin:12px 0 18px}
    .bar{height:100%; width:0%; background: linear-gradient(90deg,var(--accent), rgba(124,140,247,.9));}
    .q{background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
      border-radius:16px; padding:16px; margin-top:10px}
    .q-title{font-weight:700; margin-bottom:10px}
    input[type="text"], textarea{
      width:100%; padding:12px; border-radius:12px;
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.16);
      color:var(--text); outline:none; font-size:15px;
    }
    textarea{min-height:86px; resize:vertical}
    .choices{display:grid; gap:10px}
    .choice{display:flex; gap:10px; align-items:center; padding:12px; border-radius:14px;
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); cursor:pointer; user-select:none}
    .choice:hover{background:rgba(255,255,255,.08)}
    .choice input{accent-color:var(--accent)}
    .row{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px}
    button{
      border:0; border-radius:14px; padding:12px 14px; cursor:pointer; font-weight:700;
      color:#041015; background:linear-gradient(180deg,var(--accent), rgba(124,247,212,.88));
    }
    button.secondary{
      color:var(--text); background:rgba(255,255,255,.08); border:1px solid rgba(255,255,255,.14); font-weight:600;
    }
    button:disabled{opacity:.55; cursor:not-allowed}
    .hint{font-size:12px; color:var(--muted); margin-top:10px}
    .msg{margin-top:10px; font-weight:650}
    .msg.ok{color:var(--ok)} .msg.bad{color:var(--danger)}
    .mono{font-family: ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace}
    .box{
      margin-top:14px; padding:14px; border-radius:16px;
      background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12);
    }
    img.qr{max-width:280px; width:100%; border-radius:12px; border:1px solid rgba(255,255,255,.12)}
    .small{font-size:12px; color:var(--muted)}
  </style>
</head>

<body>
<div class="wrap">
  <div class="card">
    <div class="top">
      <div class="badge" id="stepBadge">–®–∞–≥ 1/9</div>
      <div class="badge mono" id="timer">‚è± 00:00</div>
    </div>

    <h1 id="title">üéÅ –ö–≤–µ—Å—Ç –¥–ª—è –°—Ç–∞—Å–∞</h1>
    <p id="subtitle">–¢—ã –ø–æ—á—Ç–∏ —É —Ü–µ–ª–∏. –ù–æ —Å–Ω–∞—á–∞–ª–∞ ‚Äî –ø–∞—Ä—É –∑–∞–¥–∞—á–µ–∫ üôÇ</p>

    <div class="progress"><div class="bar" id="bar"></div></div>

    <div id="stage"></div>

    <div class="row">
      <button class="secondary" id="backBtn">‚Üê –ù–∞–∑–∞–¥</button>
      <button id="nextBtn">–î–∞–ª—å—à–µ ‚Üí</button>
    </div>

    <div class="hint" id="hint"></div>
    <div class="msg" id="msg"></div>
  </div>

  <p class="small" style="margin-top:12px;">
    –í –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ —Å —ç—Ç–∏–º —Ñ–∞–π–ª–æ–º –¥–æ–ª–∂–Ω—ã –ª–µ–∂–∞—Ç—å: <span class="mono">index.html</span> –∏ <span class="mono">qr.png</span>.
  </p>
</div>

<script>
const CONFIG = {
  // ‚ùó –¢–£–¢ –¢–´ –ü–û–¢–û–ú –°–ê–ú–ê –í–ü–ò–®–ï–®–¨ –ö–û–î, –ö–û–¢–û–†–´–ô –ë–£–î–ï–¢ –ù–ê –ö–û–†–û–ë–ö–ï
  // –ù–∞–ø—Ä–∏–º–µ—Ä: secretCode: "R1CK-2025"
  secretCode: "CHANGE_ME",

  // –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Å QR, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥—ë—Ç –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å –∞—É–¥–∏–æ (audio.html –∏–ª–∏ –ª—é–±–∞—è –¥—Ä—É–≥–∞—è —Å—Å—ã–ª–∫–∞)
  qrImageSrc: "qr.png",

  // –ø—Ä–æ—Å—Ç–æ —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –ø—É—Å—Ç—ã–µ –æ—Ç–≤–µ—Ç—ã
  requireNonEmptyAnswers: true,
};

/**
 * STEPS:
 *  - intro
 *  - 7 –≤–æ–ø—Ä–æ—Å–æ–≤
 *  - –≤–≤–æ–¥ –∫–æ–¥–∞ (—Å –∫–æ—Ä–æ–±–∫–∏)
 *  - –ø–æ–∫–∞–∑ QR
 */
const STEPS = [
  {
    id: "intro",
    type: "info",
    title: "–ü—Ä–∏–≤–µ—Ç, —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ üòé",
    subtitle: "–£ —Ç–µ–±—è –º–∞–ª–µ–Ω—å–∫–∏–π –∫–≤–µ—Å—Ç. –í –∫–æ–Ω—Ü–µ –ø–æ—è–≤–∏—Ç—Å—è QR, –∞ –∑–∞ –Ω–∏–º ‚Äî –∫–æ–µ-—á—Ç–æ, —á—Ç–æ –ª—É—á—à–µ —Å–ª—É—à–∞—Ç—å –≤ –Ω–∞—É—à–Ω–∏–∫–∞—Ö.",
    body: "–≠—Ç–æ –Ω–µ —Ç–µ—Å—Ç, –∞ –±–æ–ª—å—à–µ —Å–æ–≤–º–µ—Å—Ç–Ω–∞—è —à—É—Ç–∫–∞ –∏ –º–∏–Ω–∏-–ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –∏–¥—ë—Ç –Ω–µ —Ç–∞–∫ ‚Äî –ù–∞—Å—è –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç –ø–æ–¥—Å–∫–∞–∑–∞—Ç—å üòâ"
  },

  // 1) Kotlin –∑–∞–¥–∞—á–∞ 1 ‚Äî String vs Int
  {
    id: "kotlin1",
    type: "mcq",
    title: "Kotlin –∑–∞–¥–∞—á–∞ 1 ‚Äî String vs Int",
    subtitle: "–ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–æ—Ç Kotlin-–∫–æ–¥?",
    code: 'println("2" + 2)',
    options: [
      "4",
      "22",
      "–û—à–∏–±–∫–∞",
      "–ù–∏—á–µ–≥–æ, –≤–µ–¥—å –°—Ç–∞—Å –Ω–µ –≤–∫–ª—é—á–∏–ª –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä"
    ],
    correctIndex: 1,
    wrongMsg: "–ê –≤–æ—Ç –∏ –Ω–µ—Ç—å —Å:"
  },

  // 2) You son of a bitch ‚Äî –∫—Ç–æ —Å–∫–∞–∑–∞–ª?
  {
    id: "lily",
    type: "mcq",
    title: "You son of a bitch ‚Äî –∫—Ç–æ —Å–∫–∞–∑–∞–ª?",
    subtitle: "",
    options: [
      "Lily Potter",
      "Lily Whatever-her-surname-is",
      "Lily Aldrin",
      "Lily Shmili Vily"
    ],
    correctIndex: 2,
    wrongMsg: "Please."
  },

  // 3) JS: —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 1+1
  {
    id: "js11",
    type: "text",
    title: "JS: —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç 1 + 1 –Ω–∞ —è–∑—ã–∫–µ JavaScript?",
    subtitle: "–ü–æ–¥—Å–∫–∞–∑–∫–∞: JavaScript –∏–Ω–æ–≥–¥–∞ —Å–ª–∏—à–∫–æ–º –¥—Ä—É–∂–µ–ª—é–±–µ–Ω –∫ —Å—Ç—Ä–æ–∫–∞–º.",
    placeholder: "–≤–≤–µ–¥–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç",
    correctText: "11",
    wrongMsg: "–ü–æ–ø—Ä–æ–±—É–π –±—ã—Ç—å —á—É—Ç–æ—á–∫—É –ø—Ä–æ—â–µ."
  },

  // 4) Pickle Rick
  {
    id: "pickle",
    type: "mcq",
    title: "Pickle Rick ‚Äî —Å–µ—Ä–∏—è –∏ —Å–µ–∑–æ–Ω",
    subtitle: "–í –∫–∞–∫–æ–π —Å–µ—Ä–∏–∏ –∫–∞–∫–æ–≥–æ —Å–µ–∑–æ–Ω–∞ –†–∏–∫ —Å—Ç–∞–ª –æ–≥—É—Ä—á–∏–∫–æ–º?",
    options: [
      "2 —Å–µ—Ä–∏—è 4 —Å–µ–∑–æ–Ω",
      "3 —Å–µ—Ä–∏—è 3 —Å–µ–∑–æ–Ω",
      "4 —Å–µ—Ä–∏—è 2 —Å–µ–∑–æ–Ω",
      "5 —Å–µ—Ä–∏—è 2 —Å–µ–∑–æ–Ω–∞"
    ],
    correctIndex: 1,
    wrongMsg: "Oh geez, Stas"
  },

  // 5) Kotlin –∑–∞–¥–∞—á–∞ 3 ‚Äî Elvis –æ–ø–µ—Ä–∞—Ç–æ—Ä
  {
    id: "kotlinElvis",
    type: "mcq",
    title: "Kotlin –∑–∞–¥–∞—á–∞ 3 ‚Äî Elvis –æ–ø–µ—Ä–∞—Ç–æ—Ä",
    subtitle: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä ?: –≤ Kotlin?",
    options: [
      "–≠–ª–≤–∏—Å –æ–ø–µ—Ä–∞—Ç–æ—Ä",
      "–î–∞—Ä–≤–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä",
      "–ú–æ—Ü–∞—Ä—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä",
      "–†–∏–∫ –æ–ø–µ—Ä–∞—Ç–æ—Ä"
    ],
    correctIndex: 0,
    wrongMsg: "Uh-oh, wrong timeline, Morty."
  },

  // 6) –í –ª—é–±–æ–π –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏...
  {
    id: "situation",
    type: "mcq",
    title: "–ü—Ä–æ–¥–æ–ª–∂–∏ —Ñ—Ä–∞–∑—É: ¬´–í –ª—é–±–æ–π –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏‚Ä¶¬ª",
    subtitle: "",
    options: [
      "–ì–æ–≤–æ—Ä–∏ –í—É–±–±–∞ –õ—É–±–±–∞ –¥–∞–±-–¥–∞–±",
      "–ü–æ–∫–∞–∑—ã–≤–∞–π –ø–∏—Å—å–∫—É",
      "–°–∞–¥–∏—Å—å –ø–∏—Å–∞—Ç—å –∫–æ–¥",
      "–ú–æ–∂–Ω–æ –ø—Ä–æ—è—Å–Ω–∏—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é."
    ],
    correctIndex: 1,
    wrongMsg: "–ù–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —Ç—ã –∑–Ω–∞–µ—à—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç, –Ω–µ –æ—Ç—Ä–∏—Ü–∞–π —ç—Ç–æ–≥–æ."
  },

  // 7) —Ñ–∏–Ω–∞–ª—å–Ω—ã–π "—Ç—ã–∫"
  {
    id: "love",
    type: "mcq",
    title: "–ü—Ä–æ—Å—Ç–æ —Å–¥–µ–ª–∞–π —Ç—ã–∫",
    subtitle: "–ó–¥–µ—Å—å –Ω–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤. –ù–æ –æ–¥–∏–Ω ‚Äî —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π.",
    options: [
      "–Ø —Ç–µ–±—è –ª—é–±–ª—é ‚ù§Ô∏è"
    ],
    correctIndex: 0,
    wrongMsg: "" // –ø–æ —Ñ–∞–∫—Ç—É –Ω–µ–¥–æ—Å—Ç–∏–∂–∏–º–æ, –Ω–æ –æ—Å—Ç–∞–≤–∏–º
  },

  // 8) –≤–≤–æ–¥ –∫–æ–¥–∞ —Å –∫–æ—Ä–æ–±–∫–∏
  {
    id: "code",
    type: "code",
    title: "–§–∏–Ω–∞–ª—å–Ω—ã–π —à–∞–≥: –∫–æ–¥",
    subtitle: "–í–≤–µ–¥–∏ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–ø—Ä—è—Ç–∞–Ω –Ω–∞ –∫–æ—Ä–æ–±–∫–µ. (–ù–∞—Å—è –∑–Ω–∞–µ—Ç, –≥–¥–µ –∏—Å–∫–∞—Ç—å üòâ)",
    placeholder: "–≤–≤–µ–¥–∏ –∫–æ–¥ —Å –∫–æ—Ä–æ–±–∫–∏"
  },

  // 9) –ø–æ–∫–∞–∑ QR
  {
    id: "reveal",
    type: "reveal",
    title: "üéâ –î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç",
    subtitle: "QR –ø–æ—è–≤–∏–ª—Å—è. –°–∫–∞–Ω–∏—Ä—É–π ‚Äî –æ–Ω –≤–µ–¥—ë—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–Ω–∞—Ç–µ –∫–≤–µ—Å—Ç–∞.",
  }
];

let state = { stepIndex: 0, answers: {}, codeUnlocked: false };

const el = {
  stage: document.getElementById("stage"),
  title: document.getElementById("title"),
  subtitle: document.getElementById("subtitle"),
  hint: document.getElementById("hint"),
  msg: document.getElementById("msg"),
  nextBtn: document.getElementById("nextBtn"),
  backBtn: document.getElementById("backBtn"),
  bar: document.getElementById("bar"),
  stepBadge: document.getElementById("stepBadge"),
  timer: document.getElementById("timer"),
};

function clamp(n,a,b){ return Math.max(a, Math.min(b,n)); }

function render() {
  const step = STEPS[state.stepIndex];
  const total = STEPS.length;

  el.stepBadge.textContent = `–®–∞–≥ ${state.stepIndex + 1}/${total}`;
  el.bar.style.width = `${((state.stepIndex) / (total - 1)) * 100}%`;

  el.msg.textContent = ""; el.msg.className = "msg";
  el.hint.textContent = "";

  el.title.textContent = step.title;
  el.subtitle.textContent = step.subtitle || "";

  el.backBtn.disabled = state.stepIndex === 0;
  el.nextBtn.textContent = state.stepIndex === total - 1 ? "–ì–æ—Ç–æ–≤–æ ‚ú®" : "–î–∞–ª—å—à–µ ‚Üí";

  el.stage.innerHTML = "";

  if (step.type === "info") renderInfo(step);
  if (step.type === "mcq") renderMCQ(step);
  if (step.type === "text") renderText(step);
  if (step.type === "code") renderCode(step);
  if (step.type === "reveal") renderReveal(step);
}

function renderInfo(step){
  const box = document.createElement("div");
  box.className = "q";
  box.innerHTML = `
    <div class="q-title">‚ú® –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</div>
    <p>${step.body}</p>
    <div class="box small">
      –ù–∞ —Ñ–∏–Ω–∏—à–µ –ø–æ—è–≤–∏—Ç—Å—è QR-–∫–æ–¥. –ó–∞ –Ω–∏–º ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∞—É–¥–∏–æ.<br/>
      –ê –µ—â—ë –≥–¥–µ-—Ç–æ —Ä—è–¥–æ–º –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —É–∂–µ –ª–µ–∂–∞—Ç –Ω–∞—É—à–Ω–∏–∫–∏ üòâ
    </div>
  `;
  el.stage.appendChild(box);
}

function renderMCQ(step){
  const box = document.createElement("div");
  box.className = "q";
  let extra = "";
  if (step.code){
    extra = `<pre class="mono" style="background:rgba(0,0,0,.3); padding:8px 10px; border-radius:10px; font-size:13px; margin-bottom:10px;">${step.code}</pre>`;
  }
  box.innerHTML = `<div class="q-title">${step.title}</div>${extra}`;
  const choices = document.createElement("div");
  choices.className = "choices";
  const saved = state.answers[step.id];

  step.options.forEach((opt, idx) => {
    const label = document.createElement("label");
    label.className = "choice";
    label.innerHTML = `
      <input type="radio" name="${step.id}" value="${idx}" ${String(saved)===String(idx)?"checked":""}/>
      <div>${opt}</div>
    `;
    label.addEventListener("click", () => state.answers[step.id] = idx);
    choices.appendChild(label);
  });

  box.appendChild(choices);
  el.stage.appendChild(box);
  el.hint.textContent = step.id === "love"
    ? "–¢—É—Ç –ø—Ä–∞–≤–¥–∞ –Ω–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ üôÇ"
    : "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç. –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –≤–æ–ø—Ä–æ—Å–∞—Ö –µ—Å—Ç—å –æ–¥–∏–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.";
}

function renderText(step){
  const box = document.createElement("div");
  box.className = "q";
  box.innerHTML = `<div class="q-title">${step.title}</div>`;
  const input = document.createElement("input");
  input.type = "text";
  input.placeholder = step.placeholder || "";
  input.value = state.answers[step.id] || "";
  input.addEventListener("input", e => state.answers[step.id] = e.target.value);
  box.appendChild(input);
  el.stage.appendChild(box);
}

function renderCode(step){
  const box = document.createElement("div");
  box.className = "q";
  box.innerHTML = `<div class="q-title">${step.title}</div>`;
  const input = document.createElement("input");
  input.type = "text";
  input.placeholder = step.placeholder || "";
  input.value = state.answers[step.id] || "";
  input.addEventListener("input", e => state.answers[step.id] = e.target.value);
  box.appendChild(input);

  const note = document.createElement("div");
  note.className = "small";
  note.style.marginTop = "10px";
  note.innerHTML = `–ü–æ–¥—Å–∫–∞–∑–∫–∞: –µ—Å–ª–∏ —á—Ç–æ ‚Äî <b>–ù–∞—Å—è</b> –∑–Ω–∞–µ—Ç, –≥–¥–µ —Å–ø—Ä—è—Ç–∞–Ω –∫–æ–¥ üòè`;
  box.appendChild(note);

  el.stage.appendChild(box);
}

function renderReveal(step){
  const box = document.createElement("div");
  box.className = "q";
  box.innerHTML = `
    <div class="q-title">üéÅ –§–∏–Ω–∞–ª (—á–∞—Å—Ç—å 1)</div>
    <p>QR –ø–æ—è–≤–∏–ª—Å—è. –°–∫–∞–Ω–∏—Ä—É–π –µ–≥–æ –∫–∞–º–µ—Ä–æ–π –∏–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –¥–ª—è —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è QR.</p>
    <div class="box">
      <img class="qr" src="${CONFIG.qrImageSrc}" alt="QR code"/>
      <div class="small" style="margin-top:8px;">
        –ï—Å–ª–∏ QR –Ω–µ –≤–∏–¥–Ω–æ ‚Äî –∑–Ω–∞—á–∏—Ç —Ñ–∞–π–ª <span class="mono">${CONFIG.qrImageSrc}</span> –Ω–µ –ª–µ–∂–∏—Ç —Ä—è–¥–æ–º —Å <span class="mono">index.html</span>.
      </div>
    </div>
  `;
  el.stage.appendChild(box);
  el.hint.textContent = "–°–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ø–æ QR) ‚Äî —Å –∞—É–¥–∏–æ. –ò –¥–∞, –Ω–∞—É—à–Ω–∏–∫–∏ –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è üéß";
}

function validateStep(){
  const step = STEPS[state.stepIndex];
  const val = state.answers[step.id];

  if (step.type === "info") return null;

  if (step.type === "mcq"){
    if (val === undefined) return "–í—ã–±–µ—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç üôÇ";
    if (typeof step.correctIndex === "number"){
      if (Number(val) !== step.correctIndex){
        return step.wrongMsg || "–ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç üôÇ";
      }
    }
    return null;
  }

  if (step.type === "text"){
    if (!val || String(val).trim().length < 1){
      return "–ù–∞–ø–∏—à–∏ —á—Ç–æ-–Ω–∏–±—É–¥—å üôÇ";
    }
    if (step.correctText){
      const entered = String(val).trim();
      if (entered !== step.correctText){
        return step.wrongMsg || "–ù–µ–≤–µ—Ä–Ω—ã–π –æ—Ç–≤–µ—Ç üôÇ";
      }
    }
    return null;
  }

  if (step.type === "code"){
    const entered = (val || "").trim();
    if (!entered) return "–í–≤–µ–¥–∏ –∫–æ–¥ —Å –∫–æ—Ä–æ–±–∫–∏ üôÇ";
    if (CONFIG.secretCode === "CHANGE_ME"){
      return "–ü–æ—Ö–æ–∂–µ, –∫–æ–¥ –µ—â—ë –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –≠—Ç–æ —É–∂–µ –≤–æ–ø—Ä–æ—Å –∫ –ùa—Å–µ üòâ";
    }
    if (entered !== CONFIG.secretCode){
      return "–ù–µ-–∞ üòÑ –ü—Ä–æ–≤–µ—Ä—å –∫–æ–¥ –Ω–∞ –∫–æ—Ä–æ–±–∫–µ –µ—â—ë —Ä–∞–∑ (–∏–ª–∏ —Å–ø—Ä–æ—Å–∏ –ù–∞—Å—é).";
    }
    state.codeUnlocked = true;
    return null;
  }

  if (step.type === "reveal"){
    if (!state.codeUnlocked) return "–°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ üôÇ";
    return null;
  }

  return null;
}

el.nextBtn.addEventListener("click", () => {
  if (state.stepIndex === STEPS.length - 1){
    el.msg.textContent = "‚ú® –ì–æ—Ç–æ–≤–æ. –î–∞–ª—å—à–µ ‚Äî –ø–æ QR.";
    el.msg.className = "msg ok";
    return;
  }

  const err = validateStep();
  if (err){
    el.msg.textContent = err;
    el.msg.className = "msg bad";
    return;
  }

  const next = clamp(state.stepIndex + 1, 0, STEPS.length - 1);
  if (STEPS[next].type === "reveal" && !state.codeUnlocked){
    el.msg.textContent = "–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–æ–¥ üôÇ";
    el.msg.className = "msg bad";
    return;
  }

  state.stepIndex = next;
  render();
});

el.backBtn.addEventListener("click", () => {
  state.stepIndex = clamp(state.stepIndex - 1, 0, STEPS.length - 1);
  render();
});

// –¢–∞–π–º–µ—Ä –¥–ª—è –≤–∞–π–±–∞
const startTs = Date.now();
setInterval(() => {
  const sec = Math.floor((Date.now() - startTs) / 1000);
  const mm = String(Math.floor(sec / 60)).padStart(2, "0");
  const ss = String(sec % 60).padStart(2, "0");
  el.timer.textContent = `‚è± ${mm}:${ss}`;
}, 500);

render();
</script>
</body>
</html>
